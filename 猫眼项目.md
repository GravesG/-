VO: viewModel  接受前端传来的对象

POJO： 数据层映射体

BO: 业务层对象



![image-20200712094112274](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200712094112274.png)



公共数据模块，公共工具模块

![image-20200713203529785](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200713203529785.png)





> MD5加密



> 优雅验证参数，公共请求对象封装

在Utils模块，写个入参工具类，提供参数校验方法，后续子类分别实现

![image-20200713222321232](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200713222321232.png)



提供基础工具类校验

![image-20200713223051364](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200713223051364.png)



公共返回对象封装

![image-20200713233055013](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200713233055013.png)



公共异常处理

![image-20200714215440241](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200714215440241.png)



### JWT



https://coding.imooc.com/lesson/396.html#mid=30938

Header.Payload.Signature



![image-20200714220615171](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200714220615171.png)





### Eureka

![image-20200714225736173](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200714225736173.png)



在启动类上一般使用@EnableDiscoveryClien而不是@EnableEurekaClient

因为@EnableDiscoveryClient 可以集成大部分注册中心，而@EnableEurekaClient 只对Eureka有用



### consumer 和 provider 

原始版服务调用

![image-20200715233433251](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200715233433251.png)

、弊端: ip 和端口写死，就算扩展了也无法调用



### 服务注册 ， 服务续约

注册：

- EurekaCLient 在第一次心跳的时候向EurekaServer注册（有时间差）
- 注册时会提供诸多自身元数据：主机名，端口，健康指标URL等





续约：

- EurekaCLient通过发出送心跳进行续约
-  默认情况每30秒发送一次心跳
- 如90秒内EurekaServer没有收到续约，则进行服务剔除





![image-20200716204602796](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200716204602796.png)



### Eureka面试点



CAP理论：

- 一致性 C
- 可用性 A
- 分区容错性 P

目前只可以两两组合，不能三个都满足



ZK：有限保证CP

Eureka：有限保证AP



> Eureka注册慢

- 注册慢的根本原因在于Eureka的AP特性
- Eurekaclient 延迟注册，默认30秒
- EurekaServer的响应缓存，默认30秒
- EurekaServer的刷新缓存，模拟30秒



> Eureka的自我保护

- EurekaServer会自动更新续约跟新阈值
- EurekaServer续约更新频率低于阈值则会进入保护模式
- 自我保护模式下EurekaServer不会轻易剔除任何注册信息（为了满足AP）



> EnableDiscoveryClient与EnableEurekaClient的区别

区别：
 @EnableDiscoveryClient注解是基于spring-cloud-commons依赖，并且在classpath中实现。
 @EnableEurekaClient注解是基于spring-cloud-netflix依赖，只能为eureka作用。
 @EnableEurekaClient只适用于Eureka作为注册中心，@EnableDiscoveryClient 可以是其他注册中心。





### 影院模块

![image-20200716210953471](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200716210953471.png)

![image-20200716211156775](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200716211156775.png)



### 表结构

![image-20200716211834512](C:\Users\ZeTao\AppData\Roaming\Typora\typora-user-images\image-20200716211834512.png)